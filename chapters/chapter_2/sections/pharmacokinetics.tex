\section{Pharmacokinetics} \label{PKPD}

Pharmacokinetics is the the study of drug absorption, distribution, metabolism, and excretion of a drug \cite{rosenbaum2016basic}.  Less formally,  it is the study of how drugs enter the body, distribute throughout the body, and leave the body, as well as the rates at which these phenomena occur.  Generally, modelling the time course of drug concentrations in various body compartments (e.g. the blood) is of central interest.  Understanding the time course of concentrations is important to pharmaceutical therapy as concentrations which are too high can lead to toxicity, while concentrations which are too low can lead to ineffectiveness.  Pharmacokinetic models are thus a tool to reason about the time course of drug concentrations, and in turn the drug's effectiveness or toxicity.

In this section, I review the basics of pharmacokinetic modelling and introduce the central pharmacokinetic model used in this research, describing the model using a differential equation.  Population pharmacokinetic models are discussed as a generalization of the one compartment pharmacokinetic model


\subsection{A One Compartment Pharmacokinetic Model} 

In pharmacokinetic modelling, compartmental models are used to model the time course of concentrations \cite{rosenbaum2016basic}. These models posit that the body (or relevant organs/systems of the body) is comprised of compartments from which drug can flow in and out. The rates at which the drug can enter and exit each compartment are specified, and a differential equation for each compartment can be written down and solved using methods outlined in \cref{sec:ODE}.

An example of these models used for orally-administered drugs is the one--compartment pharmacokinetic model with first order elimination.  The model posits the following \cite{wakefield1992bayesian}:  
%
\begin{itemize}
\item The rate of drug absorption from the gut  into the blood plasma ($ C $) is proportional to the amount of drug in the gut and that the proportionality constant is $ k_a $, in units $ \text{hours}^{-1} $;

\item The rate of elimination from the blood plasma is proportional to the amount of drug in the plasma compartment with proportionality constant $ k_e $, in units $ \text{hours}^{-1} $;

\item The volume of plasma in the body is $ V $, in units litres;

\item The fraction of the drug that reaches the systemic circulation is the drugâ€™s bioavailability, $F$.

\item At the time of ingestion, there is 0 drug in the blood plasma.
\end{itemize}

Let $t$ be time since ingestion of the drug.  The differential equation governing the mass transit of drug in/out of the $C$ compartment is then $dC(t)/dt = k_aFD\exp(-k_a t) - k_eC(t)$ with the initial condition $C(0) = 0$, and is a first order linear differential equation.  The concentration of the drug in the $C$ compartment can be obtained by dividing $C(t)$ by the volume of the $C$ compartment, $V$.  Using the technique of integrating factors, the differential equation can be solved to yield

\begin{equation}\label{onecompartment_PKPD_model}
	C(t) = \dfrac{F D}{V}\dfrac{k_a}{k_e - k_a}\Big(\exp(-k_at) - \exp(-k_et)\Big) \>.
\end{equation}

In the remainder of this thesis, \cref{onecompartment_PKPD_model} will be parameterized in terms of the clearance rate $Cl = V \cdot k_e$ rather than in terms of volume due to more prior information being available about the clearance rate of certain drugs as opposed to the volume of patients.  The resulting parameterization is

\begin{equation}\label{onecompartment_PKPD_cl}
	C(t) = \dfrac{F D}{Cl}\dfrac{k_ek_a}{k_e - k_a}\Big(e^{-k_at} - e^{-kt}\Big) \>.
\end{equation}

\begin{figure}[h!]
	\centering
	\includegraphics{figures/pkcurves.png}
	\caption[Non-dimensionalized solutions to pharmacokinetic differential equation] {Non-dimensionalized concentration plotted against non-dimensionalized time.  The process non-dimensionalizing the differential equation removes all units from the model, allowing for qualitative comparisons of the solution under different families of parameterization.  Here, it is shown that all parametrizations in which $\alpha = k_e/ka = 0.15$ elicit larger concentrations than those parameterizations in which $\alpha=0.4$ conditioned on $FD/V$ remaining constant.}
	\label{fig:pkcureves}
\end{figure}

\subsection{Population Pharmacokinetic Models}


Different patients may have different pharmacokinetics just by virtue of being different people (even if they match identically on important clinical and genetic covariates).  To understand the between subject variability in pharmacokientics, a population pharmacokinetic model can be constructed.  These models make the assumption that some or all of the parameters in \cref{onecompartment_PKPD_cl} (or some other pharmacokinetic model for that matter) are themselves random variables, which have some population level mean and variance which requires estimation \cite{owen2014introduction}.  As an example, the clearance rate for the $i^{th}$ patient in the population, $Cl_i$, can be considered as a draw from some population level distribution, $Cl_i \sim P(\mu, \sigma) $, where $P$ is some distribution with suitable support for the modelled parameter.  This approach is similar to non-linear mixed effect modelling; non-linear because the concentration function is non-linear in the pharmacokinetic parameters, and mixed-effects because the parameters are free to vary between patients \cite{owen2014introduction, mould2013basic}.

Many software packages exist to fit population pharmacokinetic models.  Notable examples  include NONMEM \cite{bauer2011nonmem} and Monolix \cite{noauthor_monolix_nodate} (both of which happen to be propriatary software) and Pumas \cite{rackauckas2020accelerated} which is freely available and accessed through the Julia language (which is also free), among others.  Each implementation shares similar techniques for parameter estimation, namely by optimizing the negative log likelihood (which is sometimes called the \textit{Objective Function} or OFV) \cite{bauer2011nonmem, mould2013basic, bauer_nonmem_2019}, as well as approximation methods for computing the marginal likelihood.  Several approximation techniques are made available to users, but the differences in resulting estimates from these methods can sometimes be substantial \cite{mould2013basic}.