\chapter{Background}

In this chapter, I describe the necessary background for the research presented in this thesis.  The focus of the first section is differential equations, specifically first order separable equations and the Laplace Transform.  Then, I discuss Bayesian statistics, touching on model design, model checking, and model fitting.  In the next section I discuss population pharmacokinetic models, touching on their derivation through differential equations as well as extensions to include multiple doses.  I conclude this chapter with a treatment of dynamic treatment regimes and estimation of an optimal policy through Q learning.

\section{Differential Equations}\label{sec:ODE}

\subsection{Initial Value Problems, Existence, and Uniqueness}

A differential equation is an equation which relates the derivative of an unknown function $y(t)$ to a known function $f(t, y(t), \theta)$. Here, the function $f$ may depend on parameters, $\theta$ which can be known exactly or require estimation from data. For economy of thought, dependence of $f$ on $\theta$ is implied though not always explicitly stated. A differential equation is called \textit{ordinary} (refereed to as an \textit{ODE}) if $y$ is a function of a single scalar variable $t$, which for the purposes of this thesis can be considered to be time. An ODE together with an \textit{initial condition} -- a value of $y$ at some point $t_0$ in its domain --  is refereed to as an \textit{initial value problem} (or sometimes an \textit{IVP}), 

\begin{equation}\label{IVP}
	\dfrac{dy(t)}{dt} = f(t, y(t), \theta) \quad y(t_0) = y_0
\end{equation}

\noindent If the function $f$ can be written as $f(t, y(t)) = Q(t) - I(t) y(t)$, then we call the ODE a \textit{first order linear ordinary differential equation}.  The equation is called first order because the highest order derivative is of order one, and the linear because the equation is a linear function of the derivative. 

Not every IVP which can be written down has a solution, but there do exist general criteria for existence and uniqueness to a solution for \cref{IVP}.  The only requirements are that a) $f$ be continuous in $t$, and b) $f$ be Lipschitz continuous in $y$.  Under these conditions, Picard–Lindelöf theorem \cite{morris1963ordinary}.

\begin{theorem}[\emph{Picard–Lindelöf Theorem}]
	Let $D \subseteq \mathbb{R} \times \mathbb{R}^n$ be a closed rectangle with $(t_0, y_0) \in D$, and let $f : D \to \mathbb{R}^n$ be a function that is continuous in $t$ and Lipschitz continuous in $y$.  Then, there exists some $\epsilon>0$ such that \cref{IVP} has a unique solution $y(t)$ in an interval centred at $t_0$ with radius $epsilon$.
\end{theorem}

\noindent This thesis is mainly concerned with functions which are continuous in $y$.  If a function is continuous in a variable, then it is also Lipschitz continuous.  Hence, all IVPs for which we concern ourselves with have a unique solution.


\subsection{Solutions to First Order Linear Equations}

So long as the function $f(t, y(t)) = Q(t) - I(t) y(t)$ satisfies the conditions for the Picard–Lindelöf theorem, then a solution exists and it is unique.  Assuming $Q(t)$ and $I(t)$ are written in terms of analytic functions, then the solution to \cref{IVP} can be written out analytically.  Let $P(t) = \exp(\int I(t) \, dt))$ be an \textit{integrating factor}.  Multiplying both sides of the ODE by $P(t)$ yields

\begin{align}
	\dfrac{dy}{dt} + I(t)y(t) &= Q(t) \\
	P(t)\dfrac{dy}{dt} + P(t)I(t)y(t) &= P(t)Q(t) 
\end{align}

\noindent  The form of $P(t)$ implies $P'(t) = P(t)I(t)$,and so the left hand side of the differential equation looks as if it is the result of the product rule

\begin{align}
 \dfrac{d}{dt} \Big( P(t)y(t) \Big) &= P(t)\dfrac{dy}{dt} + P(t)I(t)y(t) \\
														  &= P(t) Q(t)
\end{align}

\noindent Integrating and division by $P(t)$ (which is possible since $P(t)>0$ by construction) yields the solution to the differential equation

\begin{equation}
	y(t) = \dfrac{\int Q(t) P(t)\, dt}{P(t)}
\end{equation}

\noindent Wherein the constant of integration from the numerator is determined by using the initial condition. Our general takeaway is that so long as $f$ satisfies the conditions s for the Picard–Lindelöf theorem, and $Q(t)$ and $I(t)$ are not sufficiently complicated so as to prevent integration, then the solution to \cref{IVP} can be written down exactly.


\subsection{The Laplace Transform and Forcing Functions}

Under the conditions that a function $f$ is piecewise continuous on an interval $0 \leq t \leq A$ for any positive $A$, and that $\vert f(t) \vert \leq K \exp(at)$ when $M \leq t$ for real constants $0< K, a, M $, then the integral

$$ \int_0^\infty f(t) e^{-st} \, dt  $$ 

\noindent exists and is called \textit{The Laplace Transform}, denoted $\mathcal{L}\left\{f\right\}(s)$.  The Laplace Transform can be used to turn a first order linear differential equation into an algebraic equation, which can then be solved and inverted from $s$ space to $t$ space.  The Laplace Transform can be used to solve differential equations with discontinuous forcing functions.  These differential equations take the form

\begin{equation}
	\dfrac{dy}{dt} + I(t)y(t) = Q_1(t) + H(t)Q_2(t) \>.
\end{equation}

\noindent Here, $H(t)$ is a Heaviside step function

\begin{equation}
	H(t) = \begin{cases}  1 & x>0 \\ 0 & \mbox{else} \end{cases}
\end{equation}

\noindent  Discontinuous forcing functions appear in applications such as pharmacokinetics, wherein at some point in time the dynamics undergo a sudden forcing change (such as taking a scheduled oral dose of a drug).   Hence, the Laplace Transform is a useful technique for deriving analytical solutions to these differential equations.